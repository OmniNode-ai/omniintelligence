# Test Environment Configuration
# Purpose: Environment variables for CI/CD test infrastructure
# Usage: Copy to .env or source before running docker-compose.test.yml
#
# docker compose -f docker-compose.test.yml --env-file .env.test up -d

# =============================================================================
# Test Database Ports (avoid conflicts with dev environment)
# =============================================================================

# PostgreSQL Test Instance (dev: 5432)
TEST_POSTGRES_PORT=5433
TEST_POSTGRES_USER=archon_test
TEST_POSTGRES_PASSWORD=archon_test_password_2025
TEST_POSTGRES_DB=archon_test

# Qdrant Test Instance (dev: 6333/6334)
TEST_QDRANT_PORT=6334
TEST_QDRANT_GRPC_PORT=6335

# Memgraph Test Instance (dev: 7687/7444)
TEST_MEMGRAPH_BOLT_PORT=7688
TEST_MEMGRAPH_HTTP_PORT=7445

# Valkey Test Instance (dev: 6379)
TEST_VALKEY_PORT=6380
TEST_VALKEY_PASSWORD=archon_test_cache_2025

# =============================================================================
# Test Connection Strings (for Python tests)
# =============================================================================

# PostgreSQL Connection
TEST_DATABASE_URL=postgresql://archon_test:archon_test_password_2025@localhost:5433/archon_test

# Qdrant Connection
TEST_QDRANT_URL=http://localhost:6334
TEST_QDRANT_GRPC_URL=http://localhost:6335

# Memgraph Connection
TEST_MEMGRAPH_URI=bolt://localhost:7688

# Valkey/Redis Connection
TEST_VALKEY_URL=redis://:archon_test_cache_2025@localhost:6380/0

# =============================================================================
# Test Performance Timeouts (CI/CD optimized)
# =============================================================================

# Cache Performance Tests
COLD_CACHE_TIMEOUT_MS=18000          # 2x default for CI/CD (9000 → 18000)
WARM_CACHE_TIMEOUT_MS=2000           # 2x default for CI/CD (1000 → 2000)
PARALLEL_QUERY_TIMEOUT_MS=10000      # 2x default for CI/CD (5000 → 10000)
RETRY_TIMEOUT_MS=30000               # 2x default for CI/CD (15000 → 30000)
CONNECTION_POOL_TIMEOUT_MS=10000     # 2x default for CI/CD (5000 → 10000)
FULL_BENCHMARK_TIMEOUT_MS=60000      # 2x default for CI/CD (30000 → 60000)

# Cache Operation Tests
CACHE_GET_TIMEOUT_MS=2000            # 2x default for CI/CD (1000 → 2000)
CACHE_SET_TIMEOUT_MS=2000            # 2x default for CI/CD (1000 → 2000)
CACHE_CLEAR_TIMEOUT_MS=10000         # 2x default for CI/CD (5000 → 10000)
LARGE_RESULT_TIMEOUT_MS=20000        # 2x default for CI/CD (10000 → 20000)
CONCURRENT_WRITE_TIMEOUT_MS=10000    # 2x default for CI/CD (5000 → 10000)
CACHE_EVICTION_TIMEOUT_MS=20000      # 2x default for CI/CD (10000 → 20000)
NETWORK_PARTITION_TIMEOUT_MS=10000   # 2x default for CI/CD (5000 → 10000)

# =============================================================================
# Test Configuration Flags
# =============================================================================

# Enable/disable specific test modes
ENABLE_CACHE=true
ENABLE_SLOW_TESTS=false              # Skip slow tests in fast CI pipelines
ENABLE_FLAKY_TESTS=true              # Enable flaky tests with retries

# Pytest Configuration
PYTEST_WORKERS=auto                  # Parallel test execution (auto-detect cores)
PYTEST_MAX_FAIL=5                    # Stop after N failures
PYTEST_VERBOSE=true                  # Verbose output for CI/CD

# =============================================================================
# CI/CD Environment Detection
# =============================================================================

# Set to true when running in CI/CD
CI_MODE=false

# GitHub Actions Detection
# GITHUB_ACTIONS=true                # Set automatically by GitHub Actions
# GITHUB_WORKFLOW=test-suite         # Workflow name
# GITHUB_RUN_ID=12345                # Run ID

# GitLab CI Detection
# CI=true                            # Set automatically by GitLab CI
# GITLAB_CI=true                     # GitLab-specific flag
# CI_JOB_ID=12345                    # Job ID

# =============================================================================
# Test Data and Fixtures
# =============================================================================

# Test data directories (optional)
TEST_FIXTURES_DIR=./tests/fixtures
TEST_DATA_DIR=./tests/data
TEST_OUTPUT_DIR=./tests/output

# =============================================================================
# Logging and Debugging
# =============================================================================

# Log levels for test services
LOG_LEVEL=WARNING                    # Reduce log noise in tests
QDRANT_LOG_LEVEL=WARN
MEMGRAPH_LOG_LEVEL=WARNING
VALKEY_LOG_LEVEL=warning

# Test debugging
DEBUG_TESTS=false                    # Enable detailed test debugging
CAPTURE_LOGS=true                    # Capture service logs during tests
