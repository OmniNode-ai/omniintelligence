[pytest]
# Pytest configuration for Pattern Learning Phase 1 Foundation Tests
# Track: Track 3-1.5 - Comprehensive Test Suite Generation

# Common test arguments
addopts =
    --strict-markers
    --strict-config
    --cov=src.pattern_learning
    --cov-report=term-missing
    --cov-report=html:htmlcov
    --cov-fail-under=85
    -ra
    -v
    --tb=short
    --asyncio-mode=auto

# Test discovery paths
testpaths = .
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Custom markers
markers =
    integration: Integration tests requiring external databases
    qdrant: Tests requiring Qdrant vector database (Phase 2)
    slow: Tests that are known to be slow (>1s)
    unit: Fast unit tests (<100ms)
    asyncio: Async tests using pytest-asyncio

# Warnings filter
filterwarnings =
    ignore::DeprecationWarning:asyncpg
    ignore::ResourceWarning
    ignore::pytest.PytestUnraisableExceptionWarning

# Timeout for individual tests (prevent hanging)
timeout = 30

# Minimum Python version
minversion = 3.11

# Async test configuration
asyncio_mode = auto

[coverage:run]
# Coverage configuration
source = src/pattern_learning
omit =
    */tests/*
    */test_*.py
    */__init__.py
    */example_usage.py
branch = True
parallel = True

[coverage:report]
# Coverage report configuration
precision = 2
show_missing = True
skip_covered = False

# Exclude lines from coverage
exclude_lines =
    pragma: no cover
    if __name__ == "__main__":
    if TYPE_CHECKING:
    if not ASYNCPG_AVAILABLE:
    raise NotImplementedError
    @abstractmethod
    @overload
    class .*\bProtocol\):
    # Phase 2
    # Not implemented

[coverage:html]
# HTML coverage report
directory = htmlcov
