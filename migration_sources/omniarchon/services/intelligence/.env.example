# Intelligence Service Environment Configuration
# Copy this file to .env and update values as needed

# =============================================================================
# SERVICE CONFIGURATION
# =============================================================================

# Service Port
INTELLIGENCE_SERVICE_PORT=8053

# Log Level (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# =============================================================================
# DATABASE CONNECTIONS
# =============================================================================

# Memgraph Knowledge Graph
MEMGRAPH_URI=bolt://memgraph:7687

# PostgreSQL (for document freshness and traceability)
DATABASE_URL=postgresql://user:password@localhost:5432/archon
TRACEABILITY_DB_URL=postgresql://user:password@localhost:5432/traceability

# Supabase
# SUPABASE_SERVICE_KEY removed - now using direct PostgreSQL via POSTGRES_* variables

# =============================================================================
# AI/ML SERVICES
# =============================================================================

# Ollama for embeddings
OLLAMA_BASE_URL=http://192.168.86.200:11434

# OpenAI Configuration
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_EMBEDDING_MODEL=text-embedding-3-small
OPENAI_MAX_RETRIES=3
OPENAI_TIMEOUT=30

# =============================================================================
# SERVICE DISCOVERY
# =============================================================================
# Configure service URLs for distributed deployment.
# Default values work for local Docker Compose setup.
#
# For remote deployment, update these to point to actual service hosts:
#   INTELLIGENCE_SERVICE_URL=http://archon-intelligence:8053
#   SEARCH_SERVICE_URL=http://archon-search:8055
#   BRIDGE_SERVICE_URL=http://archon-bridge:8054
#   etc.

# Intelligence Service (core quality, performance, pattern learning APIs)
INTELLIGENCE_SERVICE_URL=http://localhost:8053

# Search Service (RAG queries, vector search, code examples)
SEARCH_SERVICE_URL=http://localhost:8055

# Bridge Service (event translation, metadata stamping)
BRIDGE_SERVICE_URL=http://localhost:8054

# Qdrant Vector Database (see QDRANT VECTOR DATABASE section for additional config)
QDRANT_URL=http://localhost:6333

# Archon API Server
ARCHON_API_URL=http://localhost:8181

# Metadata Stamping Service (OmniNode remote service)
METADATA_STAMPING_SERVICE_URL=http://192.168.86.200:8057

# Language Extraction Service
LANGEXTRACT_SERVICE_URL=http://localhost:8156

# =============================================================================
# KAFKA CONFIGURATION (MVP Day 3: Event-driven Intelligence Handlers)
# =============================================================================

# Kafka Connection
# For Docker: omninode-bridge-redpanda:9092
# For Local: localhost:19092
KAFKA_BOOTSTRAP_SERVERS=omninode-bridge-redpanda:9092

# Consumer Configuration
KAFKA_CONSUMER_GROUP=archon-intelligence
KAFKA_AUTO_OFFSET_RESET=earliest
KAFKA_ENABLE_AUTO_COMMIT=true
KAFKA_MAX_POLL_RECORDS=50
KAFKA_SESSION_TIMEOUT_MS=30000

# Codegen Request Topics
KAFKA_CODEGEN_VALIDATE_REQUEST=omninode.codegen.request.validate.v1
KAFKA_CODEGEN_ANALYZE_REQUEST=omninode.codegen.request.analyze.v1
KAFKA_CODEGEN_PATTERN_REQUEST=omninode.codegen.request.pattern.v1
KAFKA_CODEGEN_MIXIN_REQUEST=omninode.codegen.request.mixin.v1

# Codegen Response Topics
KAFKA_CODEGEN_VALIDATE_RESPONSE=omninode.codegen.response.validate.v1
KAFKA_CODEGEN_ANALYZE_RESPONSE=omninode.codegen.response.analyze.v1
KAFKA_CODEGEN_PATTERN_RESPONSE=omninode.codegen.response.pattern.v1
KAFKA_CODEGEN_MIXIN_RESPONSE=omninode.codegen.response.mixin.v1

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Vector Search
MAX_BATCH_SIZE=100
DEFAULT_SEARCH_LIMIT=10
DEFAULT_HNSW_EF=128
TARGET_SEARCH_LATENCY_MS=100.0
TARGET_BATCH_LATENCY_MS=2000.0

# Document Freshness
DOCUMENT_EVENT_SUBSCRIPTION=true
DEFAULT_EXTRACTION_MODE=standard
ENABLE_MULTILINGUAL_EXTRACTION=true
ENABLE_SEMANTIC_ANALYSIS=true
MAX_CONCURRENT_EXTRACTIONS=5
EXTRACTION_TIMEOUT_SECONDS=300

# =============================================================================
# QDRANT VECTOR DATABASE
# =============================================================================
# QDRANT_URL is configured in SERVICE DISCOVERY section above

QDRANT_API_KEY=
QDRANT_COLLECTION_NAME=intelligence_patterns
VECTOR_DIMENSIONS=1536

# =============================================================================
# EVENT SYSTEM
# =============================================================================

EVENT_BUS_ENABLED=true

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Consumer Control
KAFKA_ENABLE_CONSUMER=true

# Backpressure Control
# Maximum concurrent events being processed (prevents memory exhaustion under high load)
KAFKA_MAX_IN_FLIGHT=100

# =============================================================================
# MONITORING & ALERTING
# =============================================================================

# Slack Alerting Configuration
# Enable/disable Slack alerting for event processing failures
SLACK_ALERTING_ENABLED=true

# Slack webhook URL for sending alerts (required if SLACK_ALERTING_ENABLED=true)
# Get your webhook URL from: https://api.slack.com/messaging/webhooks
# Example: https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_WEBHOOK_URL=

# =============================================================================
# PERFORMANCE TEST CONFIGURATION
# =============================================================================
# Duration values for performance tests (in milliseconds)
# Adjust these values for different CI/CD environments or testing scenarios

# Fast operation duration (< 100ms)
TEST_DURATION_FAST_MS=50

# Medium operation duration (100-200ms)
TEST_DURATION_MEDIUM_MS=100

# Slow operation duration (500-1000ms)
TEST_DURATION_SLOW_MS=500

# Very slow operation duration (> 1000ms)
TEST_DURATION_VERY_SLOW_MS=1500

# Test timeout values (in seconds)
TEST_TIMEOUT_SEC=5

# =============================================================================
# VALIDATION & DOCUMENTATION
# =============================================================================
# See docs/ENVIRONMENT_VARIABLES.md for comprehensive documentation of all variables
# including validation requirements, security best practices, and troubleshooting guides
