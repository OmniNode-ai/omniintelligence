# Security-focused custom quality rules
# Used for testing security rule enforcement

project_id: security_project

custom_rules:
  # Security pattern rules
  - rule_id: no_hardcoded_secrets
    rule_type: pattern
    description: "Code must not contain hardcoded passwords or API keys"
    severity: critical
    weight: 0.3
    enabled: true
    forbids: '(password|api_key|secret)\s*=\s*["\'][^"\']{8,}'

  - rule_id: no_sql_injection_risk
    rule_type: pattern
    description: "SQL queries must use parameterized statements"
    severity: critical
    weight: 0.3
    enabled: true
    forbids: 'execute\s*\(\s*f["\']|execute\s*\(\s*["\'].*\{.*\}'

  - rule_id: require_input_validation
    rule_type: pattern
    description: "User input handlers must include validation"
    severity: warning
    weight: 0.2
    enabled: true
    pattern: '(validate|sanitize|clean).*\\('

  - rule_id: require_error_handling
    rule_type: pattern
    description: "Critical operations must have try-except blocks"
    severity: warning
    weight: 0.2
    enabled: true
    pattern: 'try:\\s*\\n'
