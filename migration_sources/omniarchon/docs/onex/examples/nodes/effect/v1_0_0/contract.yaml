# ONEX Canary Impure Tool Contract - AI Quick Reference
# 30-SECOND COMPREHENSION: Stateful processing with side effects, file operations, HTTP requests
# TIER: 2 (Stateful) | PATTERN: impure_stateful | REFERENCE: Perfect canonical implementation

contract_version: {major: 1, minor: 0, patch: 0}
node_name: canary_impure_tool
node_version: {major: 1, minor: 0, patch: 0}
contract_name: canary_impure_tool_contract
description: "Canonical reference for stateful processing with side effects and external integrations"
author: ONEX Framework Team
created_at: "2025-08-02"
tool_type: canary
node_tier: 2
node_classification: impure_stateful

# === NODEBASE SPECIFICATION (REQUIRED) ===
# Enables automatic tool resolution and instantiation
tool_specification:
  main_tool_class: "ToolCanaryImpureProcessor"
  container_injection: "ONEXContainer"
  business_logic_pattern: "stateful"
  protocol_interface: "ProtocolCanaryImpure"
  model_prefix: "ModelCanaryImpure"
  supports_cli: true
  supports_event_bus: true
  tier: 2

# === AI QUICK REFERENCE ===
# Essential information for 30-second AI comprehension
input_state:
  required: ["action", "version", "side_effect_operation"]
  optional: ["target_path", "content_data", "external_url", "sandbox_mode"]
  validation: strict
  full_schema: {$ref: "contracts/contract_models.yaml#/input_state"}

output_state:
  provides: ["exit_code", "side_effect_result", "file_operation_result", "http_request_result", "audit_result", "security_assessment"]
  format: structured_object
  full_schema: {$ref: "contracts/contract_models.yaml#/output_state"}

# === BUSINESS LOGIC ===
capabilities:
  - "Stateful file system operations (read/write/delete)"
  - "HTTP requests with comprehensive response handling"
  - "Database operations with transaction management"
  - "Audit logging with security assessment"
  - "External service integrations"
  - "Side effect management with rollback capabilities"

operations:
  file_operations: ["file_write", "file_read", "file_delete"]
  http_operations: ["http_request", "external_api_call"]
  database_operations: ["database_query"]
  audit_operations: ["audit_log"]
  external_integrations: ["email_send"]

# === CLI INTERFACE ===
cli_parameters: {$ref: "contracts/contract_cli.yaml#/cli_parameters"}

# === INFRASTRUCTURE ===
dependencies:
  - {name: "contract_loader", type: "utility", class: "UtilityContractLoader"}
  - {name: "file_system", type: "protocol", class: "ProtocolFileSystem"}
  - {name: "http_client", type: "protocol", class: "ProtocolHttpClient"}
  - {name: "event_bus", type: "protocol", class: "ProtocolEventBus",}

infrastructure:
  event_bus: {strategy: "auto", env_variable: "EVENT_BUS_URL", service_name: "onex-event-bus"}
  security: {sandbox_mode: true, risk_assessment: true}

# === DETAILED SPECIFICATIONS ===
# Reference to comprehensive subcontracts
subcontracts:
  models: {$ref: "contracts/contract_models.yaml"}
  cli: {$ref: "contracts/contract_cli.yaml"}
  actions: {$ref: "contracts/contract_actions.yaml"}
  examples: {$ref: "contracts/contract_examples.yaml"}
  validation: {$ref: "contracts/contract_validation.yaml"}

# === PERFORMANCE & CONSTRAINTS ===
execution_capabilities:
  max_concurrent_executions: 10
  timeout_ms: 30000
  memory_limit_mb: 512
  supports_rollback: true
  audit_logging: true

hash: TBD_GENERATE_AFTER_CREATION
last_modified_at: '2025-08-02T00:00:00Z'
