# Test Environment Configuration
# Performance test timeout configurations (milliseconds)
#
# Purpose: Make test timeouts configurable for different CI/CD environments
# and local testing scenarios to reduce flakiness.
#
# Usage:
#   pytest tests/                    # Uses defaults below
#   COLD_CACHE_TIMEOUT_MS=15000 pytest tests/  # Override via environment
#
# CI/CD Recommendations:
#   - Use 2x defaults in shared CI/CD runners (resource contention)
#   - Use 1.5x defaults in dedicated CI/CD runners
#   - Use defaults for local development

# Cold Cache Performance (First query, no cached results)
# Target: <7-9s baseline, but allow margin for slower CI/CD environments
# Default: 9000ms (9s)
COLD_CACHE_TIMEOUT_MS=9000

# Warm Cache Performance (Repeated query with cache hits)
# Target: <100ms ideal, <1000ms acceptable
# Default: 1000ms (1s)
WARM_CACHE_TIMEOUT_MS=1000

# Parallel Query Performance (Multiple concurrent queries with cache)
# Target: <5000ms with shared cache efficiency
# Default: 5000ms (5s)
PARALLEL_QUERY_TIMEOUT_MS=5000

# Retry Logic Performance (Service failures with exponential backoff)
# Includes: 3 retries with 1s → 2s → 4s delays
# Default: 15000ms (15s) to allow for all retry attempts
RETRY_TIMEOUT_MS=15000

# Connection Pool Performance (HTTP/2 connection reuse)
# Target: Fast connection establishment and reuse
# Default: 5000ms (5s)
CONNECTION_POOL_TIMEOUT_MS=5000

# Full Benchmark Timeout (Comprehensive performance suite)
# Includes: Cold cache + warm cache + statistics collection
# Default: 30000ms (30s)
FULL_BENCHMARK_TIMEOUT_MS=30000

# Cache Operation Timeouts
# Redis/Valkey operation timeouts for cache tests
CACHE_GET_TIMEOUT_MS=1000
CACHE_SET_TIMEOUT_MS=1000
CACHE_CLEAR_TIMEOUT_MS=5000

# Edge Case Test Timeouts
# Large result caching (>10MB data)
LARGE_RESULT_TIMEOUT_MS=10000

# Concurrent writes (race condition testing)
CONCURRENT_WRITE_TIMEOUT_MS=5000

# Cache eviction under memory pressure
CACHE_EVICTION_TIMEOUT_MS=10000

# Network partition simulation
NETWORK_PARTITION_TIMEOUT_MS=5000

# Test Database Configuration
# Use separate test database to avoid conflicts
VALKEY_TEST_DB=15
VALKEY_TEST_URL=redis://localhost:6379/15

# Test Retry Configuration
# Number of times to retry flaky tests
PYTEST_FLAKY_RERUNS=2
PYTEST_FLAKY_DELAY=1

# Performance Benchmark Configuration
# Save detailed benchmark reports
BENCHMARK_SAVE_REPORT=true
BENCHMARK_REPORT_DIR=reports/performance
