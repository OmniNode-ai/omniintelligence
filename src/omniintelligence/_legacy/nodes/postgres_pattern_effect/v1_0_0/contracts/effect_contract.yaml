# ONEX Effect Contract - Postgres Pattern Effect
# Migrated to strict ONEX schema

name: postgres_pattern_effect
version:
  major: 1
  minor: 0
  patch: 0

description: |
  Effect node for storing pattern lineage in PostgreSQL.
  Maintains traceability for pattern learning across all 4 phases.
  Stores pattern definitions, matches, scores, and lineage.

node_type: effect

# Fully qualified model class names
input_model: omniintelligence.nodes.postgres_pattern_effect.v1_0_0.models.ModelPostgresPatternInput
output_model: omniintelligence.nodes.postgres_pattern_effect.v1_0_0.models.ModelPostgresPatternOutput

# I/O operations (required for effect nodes)
io_operations:
  - operation_type: database_write
    atomic: true
    backup_enabled: false
    timeout_seconds: 30
    validation_enabled: true

  - operation_type: database_query
    atomic: false
    backup_enabled: false
    timeout_seconds: 30
    validation_enabled: true

  - operation_type: database_update
    atomic: true
    backup_enabled: false
    timeout_seconds: 30
    validation_enabled: true

# Transaction management
transaction_management:
  enabled: true
  isolation_level: read_committed

# Retry policies
retry_policies:
  max_attempts: 3
  circuit_breaker_enabled: true
  circuit_breaker_threshold: 3

# Dependencies
dependencies:
  - name: ProtocolDatabase
    dependency_type: protocol
    required: true
    description: PostgreSQL database service

# Author and tags
author: omniintelligence
tags:
  - effect
  - postgresql
  - pattern-storage
  - lineage
  - traceability
